-- My takeaway from this week: 
-- From my query, if I just use "COUNT(DISTINCT m.Rx_name)", I can count unique drug names per provider. 
-- However, if I use "COUNT(DISTINCT m.Rx_name || m.RX_date || m.RX_date ) AS drug_count", I can count each unique combination of drug name + prescription date and the drug count will be higher (in this case).



SELECT 
    v.Attending_md As Provider_name,
    COUNT(DISTINCT v.Pid) AS visit_count,
    COUNT(DISTINCT m.Rx_name) AS drug_count,
    COUNT(DISTINCT l.Lab_name) AS lab_count
FROM Visit v
LEFT JOIN Medications m ON v.attending_md = m.prescribing_md
LEFT JOIN Labs l ON v.attending_md = l.ordering_md
GROUP BY v.Attending_md;
